{
  "openapi": "3.0.1",
  "info": {
    "title": "AUTH API",
    "version": "1.0.0",
    "description": "Elexify Admin & User Authentication Service"
  },

  "servers": [
    {
      "url": "/api/v1/auth",
      "description": "Base API Server"
    }
  ],

  "tags": [{ "name": "UserAuth" }, { "name": "AdminAuth" }],

  "paths": {
    "/user/send-otp": {
      "post": {
        "tags": ["UserAuth"],
        "summary": "Send OTP",
        "description": "Send OTP to user's registered mobile number or email",
        "requestBody": {
          "$ref": "./resources/site/auth/sendOtp.json"
        },
        "responses": {
          "200": { "$ref": "#/components/responses/success" },
          "400": { "$ref": "#/components/responses/badRequest" },
          "404": { "$ref": "#/components/responses/notFound" },
          "429": {
            "description": "Too Many Requests",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/errorResponse" },
                "example": { "error": "OTP request limit exceeded" }
              }
            }
          },
          "500": { "$ref": "#/components/responses/serverError" }
        }
      }
    },

    "/user/verify-otp": {
      "post": {
        "tags": ["UserAuth"],
        "summary": "Verify OTP",
        "description": "Verify OTP sent to user's registered mobile number or email",
        "requestBody": {
          "$ref": "./resources/site/auth/verifyOtp.json"
        },
        "responses": {
          "200": { "$ref": "#/components/responses/success" },
          "400": { "$ref": "#/components/responses/badRequest" },
          "404": { "$ref": "#/components/responses/notFound" },
          "429": {
            "description": "Too Many Requests",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/errorResponse" },
                "example": { "error": "OTP verification failed" }
              }
            }
          },
          "500": { "$ref": "#/components/responses/serverError" }
        }
      }
    },

    "/user/login": {
      "post": {
        "tags": ["UserAuth"],
        "summary": "User Login",
        "description": "Validate user credentials",
        "requestBody": {
          "$ref": "./resources/site/auth/login.json"
        },
        "responses": {
          "200": { "$ref": "#/components/responses/success" },
          "400": { "$ref": "#/components/responses/badRequest" },
          "401": { "$ref": "#/components/responses/unauthorized" },
          "403": { "$ref": "#/components/responses/forbidden" },
          "404": { "$ref": "#/components/responses/notFound" },
          "500": { "$ref": "#/components/responses/serverError" }
        }
      }
    },

    "/user/request-password-reset": {
      "post": {
        "tags": ["UserAuth"],
        "summary": "User Password Reset Request",
        "description": "Send reset link to user email",
        "requestBody": {
          "$ref": "./resources/site/auth/requestPasswordReset.json"
        },
        "responses": {
          "200": { "$ref": "#/components/responses/success" },
          "400": { "$ref": "#/components/responses/badRequest" },
          "404": { "$ref": "#/components/responses/notFound" },
          "500": { "$ref": "#/components/responses/serverError" }
        }
      }
    },

    "/user/reset-password": {
      "post": {
        "tags": ["UserAuth"],
        "summary": "User Reset Password",
        "description": "Reset user password using token",
        "requestBody": {
          "$ref": "./resources/site/auth/resetPassword.json"
        },
        "responses": {
          "200": { "$ref": "#/components/responses/success" },
          "400": { "$ref": "#/components/responses/badRequest" },
          "401": { "$ref": "#/components/responses/unauthorized" },
          "403": { "$ref": "#/components/responses/forbidden" },
          "404": { "$ref": "#/components/responses/notFound" },
          "500": { "$ref": "#/components/responses/serverError" }
        }
      }
    },
    "/admin/login": {
      "post": {
        "tags": ["AdminAuth"],
        "summary": "Admin Login",
        "description": "Validate admin credentials",
        "requestBody": {
          "$ref": "./resources/site/auth/login.json"
        },
        "responses": {
          "200": { "$ref": "#/components/responses/success" },
          "400": { "$ref": "#/components/responses/badRequest" },
          "401": { "$ref": "#/components/responses/unauthorized" },
          "403": { "$ref": "#/components/responses/forbidden" },
          "404": { "$ref": "#/components/responses/notFound" },
          "500": { "$ref": "#/components/responses/serverError" }
        }
      }
    },

    "/admin/request-password-reset": {
      "post": {
        "tags": ["AdminAuth"],
        "summary": "Admin Password Reset Request",
        "description": "Send reset link to admin email",
        "requestBody": {
          "$ref": "./resources/site/auth/requestPasswordReset.json"
        },
        "responses": {
          "200": { "$ref": "#/components/responses/success" },
          "400": { "$ref": "#/components/responses/badRequest" },
          "404": { "$ref": "#/components/responses/notFound" },
          "500": { "$ref": "#/components/responses/serverError" }
        }
      }
    },

    "/admin/reset-password": {
      "post": {
        "tags": ["AdminAuth"],
        "summary": "Admin Reset Password",
        "description": "Reset admin password using token",
        "requestBody": {
          "$ref": "./resources/site/auth/resetPassword.json"
        },
        "responses": {
          "200": { "$ref": "#/components/responses/success" },
          "400": { "$ref": "#/components/responses/badRequest" },
          "401": { "$ref": "#/components/responses/unauthorized" },
          "403": { "$ref": "#/components/responses/forbidden" },
          "404": { "$ref": "#/components/responses/notFound" },
          "500": { "$ref": "#/components/responses/serverError" }
        }
      }
    }
  },

  "components": {
    "schemas": {
      "errorResponse": {
        "type": "object",
        "properties": {
          "error": { "type": "string" }
        }
      },
      "successResponseObject": {
        "type": "object"
      }
    },

    "responses": {
      "success": {
        "description": "Success",
        "content": {
          "application/json": {
            "schema": { "$ref": "#/components/schemas/successResponseObject" }
          }
        }
      },
      "badRequest": {
        "description": "Bad Request",
        "content": {
          "application/json": {
            "schema": { "$ref": "#/components/schemas/errorResponse" },
            "example": { "error": "Bad request" }
          }
        }
      },
      "unauthorized": {
        "description": "Unauthorized",
        "content": {
          "application/json": {
            "schema": { "$ref": "#/components/schemas/errorResponse" },
            "example": { "error": "Unauthorized access" }
          }
        }
      },
      "forbidden": {
        "description": "Forbidden",
        "content": {
          "application/json": {
            "schema": { "$ref": "#/components/schemas/errorResponse" },
            "example": { "error": "Forbidden access" }
          }
        }
      },
      "notFound": {
        "description": "Not Found",
        "content": {
          "application/json": {
            "schema": { "$ref": "#/components/schemas/errorResponse" },
            "example": { "error": "User/Admin not found" }
          }
        }
      },
      "serverError": {
        "description": "Server Error",
        "content": {
          "application/json": {
            "schema": { "$ref": "#/components/schemas/errorResponse" },
            "example": { "error": "Something went wrong" }
          }
        }
      }
    },

    "securitySchemes": {
      "ApiKeyAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "x-api-key"
      },
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  }
}
